* $Id$
C
C
C
	SUBROUTINE HIPTDI(PT,PTMAX,IOPT)
#define BLANKET_SAVE
#include "hiparnt.inc"
	SAVE
	IF(IOPT.EQ.2) THEN
		PT=HIRND2(7,0.0,PTMAX)
		IF(PT.GT.HIPR1(8)) 
     &		PT=HIPR1(2)*SQRT(-ALOG(EXP(-HIPR1(8)**2/HIPR1(2)**2)
     &			-RLU_HIJING(0)*(EXP(-HIPR1(8)**2/HIPR1(2)**2)-
     &			EXP(-PTMAX**2/HIPR1(2)**2))))

	ELSE
		PT=HIPR1(2)*SQRT(-ALOG(1.0-RLU_HIJING(0)*
     &			(1.0-EXP(-PTMAX**2/HIPR1(2)**2))))
	ENDIF
	PTMAX0=MAX(PTMAX,0.01)
	PT=MIN(PTMAX0-0.01,PT)
	RETURN
	END
